(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6045],{12432:(e,a,s)=>{Promise.resolve().then(s.bind(s,76236))},26126:(e,a,s)=>{"use strict";s.d(a,{E:()=>n});var r=s(95155);s(12115);var t=s(74466),l=s(59434);let i=(0,t.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",success:"border-transparent bg-success text-success-foreground hover:bg-success/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:a,variant:s,...t}=e;return(0,r.jsx)("div",{className:(0,l.cn)(i({variant:s}),a),...t})}},38275:(e,a,s)=>{"use strict";s.d(a,{Q:()=>l});var r=s(90858);let t=(0,r.c7)();async function l(e,a){if(!e)throw Error("Nenhum arquivo fornecido para o upload.");let s=(0,r.KR)(t,a);return await (0,r.D)(s,e),await (0,r.qk)(s)}},46102:(e,a,s)=>{"use strict";s.d(a,{Bc:()=>n,ZI:()=>c,k$:()=>o,m_:()=>d});var r=s(95155),t=s(12115),l=s(78082),i=s(59434);let n=l.Kq,d=l.bL,o=l.l9,c=t.forwardRef((e,a)=>{let{className:s,sideOffset:t=4,...n}=e;return(0,r.jsx)(l.UC,{ref:a,sideOffset:t,className:(0,i.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})});c.displayName=l.UC.displayName},50926:(e,a,s)=>{"use strict";s.d(a,{CF:()=>n,VM:()=>d,eg:()=>o,x:()=>i});var r=s(35317),t=s(56104),l=s(38275);let i=async(e,a)=>{try{if(!e)throw Error("UID do usu\xe1rio \xe9 necess\xe1rio para o upload.");if(!a)throw Error("Nenhum arquivo selecionado.");let s=await (0,l.Q)(a,"profile-pictures/".concat(e,"/profile.jpg"));return await o(e,{photoURL:s}),s}catch(e){throw console.error("Erro ao fazer upload da foto de perfil:",e),Error("N\xe3o foi poss\xedvel fazer o upload da imagem.")}},n=async()=>{try{let e=(0,r.rJ)(t.db,"users"),a=await (0,r.GG)(e),s=[];return a.forEach(e=>{s.push({uid:e.id,...e.data()})}),s}catch(e){return console.error("Error getting all users:",e),[]}},d=async e=>{try{let a=(0,r.H9)(t.db,"users",e),s=await (0,r.x7)(a);if(s.exists())return{uid:e,...s.data()};return console.log("No such document!"),null}catch(e){return console.error("Error getting user profile:",e),null}},o=async(e,a)=>{try{let s=(0,r.H9)(t.db,"users",e);await (0,r.mZ)(s,a)}catch(e){throw console.error("Error updating user profile:",e),e}}},66695:(e,a,s)=>{"use strict";s.d(a,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>i,aR:()=>n,wL:()=>u});var r=s(95155),t=s(12115),l=s(59434);let i=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("div",{ref:a,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t})});i.displayName="Card";let n=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("div",{ref:a,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...t})});n.displayName="CardHeader";let d=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("div",{ref:a,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s),...t})});d.displayName="CardTitle";let o=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("div",{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",s),...t})});o.displayName="CardDescription";let c=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("div",{ref:a,className:(0,l.cn)("p-6 pt-0",s),...t})});c.displayName="CardContent";let u=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("div",{ref:a,className:(0,l.cn)("flex items-center p-6 pt-0",s),...t})});u.displayName="CardFooter"},76236:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>E});var r=s(95155),t=s(12115),l=s(50926),i=s(66695),n=s(85127),d=s(44838),o=s(46102),c=s(62523),u=s(26126),m=s(30285),x=s(50286),f=s(75074),p=s(50172),h=s(31554),j=s(75943),N=s(3561),g=s(54165),v=s(85057),b=s(87481),y=s(91394);function w(e){var a;let{user:s,isOpen:i,onOpenChange:n,onUserUpdate:d}=e,[o,u]=(0,t.useState)({}),[x,f]=(0,t.useState)(null),[p,h]=(0,t.useState)(!1),j=(0,t.useRef)(null),{toast:N}=(0,b.dj)();(0,t.useEffect)(()=>{s&&u({displayName:s.displayName||"",cpf:s.cpf||"",phone:s.phone||"",photoURL:s.photoURL})},[s]);let w=e=>{let{id:a,value:s}=e.target;u(e=>({...e,[a]:s}))},A=()=>{var e;null==(e=j.current)||e.click()},C=async()=>{if(s){h(!0);try{let e=s.photoURL;x&&(e=await (0,l.x)(s.uid,x));let a={...o,photoURL:e};await (0,l.eg)(s.uid,a);let r={...s,...a};d(r),N({title:"Sucesso!",description:"Usu\xe1rio atualizado com sucesso."}),n(!1)}catch(e){N({title:"Erro",description:"N\xe3o foi poss\xedvel atualizar o usu\xe1rio.",variant:"destructive"})}finally{h(!1)}}};return(0,r.jsx)(g.lG,{open:i,onOpenChange:n,children:(0,r.jsxs)(g.Cf,{className:"sm:max-w-[425px]",children:[(0,r.jsxs)(g.c7,{children:[(0,r.jsx)(g.L3,{children:"Editar Perfil"}),(0,r.jsx)(g.rr,{children:"Fa\xe7a altera\xe7\xf5es no seu perfil aqui. Clique em salvar para aplicar as mudan\xe7as."})]}),(0,r.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsxs)(y.eu,{className:"h-24 w-24 cursor-pointer",onClick:A,children:[(0,r.jsx)(y.BK,{src:o.photoURL,alt:null==s?void 0:s.displayName}),(0,r.jsx)(y.q5,{children:null==s||null==(a=s.displayName)?void 0:a.charAt(0).toUpperCase()})]}),(0,r.jsx)("input",{type:"file",ref:j,onChange:e=>{if(e.target.files&&e.target.files[0]){let a=e.target.files[0];f(a);let s=new FileReader;s.onloadend=()=>{u(e=>({...e,photoURL:s.result}))},s.readAsDataURL(a)}},className:"hidden",accept:"image/png, image/jpeg"}),(0,r.jsx)(m.$,{variant:"outline",onClick:A,children:"Alterar Foto"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,r.jsx)(v.J,{htmlFor:"displayName",className:"text-right",children:"Nome"}),(0,r.jsx)(c.p,{id:"displayName",value:o.displayName||"",onChange:w,className:"col-span-3"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,r.jsx)(v.J,{htmlFor:"cpf",className:"text-right",children:"CPF"}),(0,r.jsx)(c.p,{id:"cpf",value:o.cpf||"",onChange:w,className:"col-span-3"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,r.jsx)(v.J,{htmlFor:"phone",className:"text-right",children:"Telefone"}),(0,r.jsx)(c.p,{id:"phone",value:o.phone||"",onChange:w,className:"col-span-3"})]})]}),(0,r.jsx)(g.Es,{children:(0,r.jsx)(m.$,{type:"submit",onClick:C,disabled:p,children:p?"Salvando...":"Salvar Altera\xe7\xf5es"})})]})})}var A=s(41784),C=s(81427),R=s(56104);function E(){let[e,a]=(0,t.useState)([]),[s,g]=(0,t.useState)(!0),[v,y]=(0,t.useState)(null),[E,U]=(0,t.useState)(!1),[k,S]=(0,t.useState)(null),{toast:L}=(0,b.dj)(),[_,B]=(0,t.useState)(""),F=async()=>{g(!0);try{let e=await (0,l.CF)();e.sort((e,a)=>{var s,r;return((null==(s=a.createdAt)?void 0:s.seconds)||0)-((null==(r=e.createdAt)?void 0:r.seconds)||0)}),a(e)}catch(e){L({title:"Erro ao buscar usu\xe1rios.",variant:"destructive"})}finally{g(!1)}};(0,t.useEffect)(()=>{F()},[]);let H=(0,t.useMemo)(()=>_?e.filter(e=>{let a="".concat(e.firstName||""," ").concat(e.lastName||"").toLowerCase(),s=e.email.toLowerCase(),r=_.toLowerCase();return a.includes(r)||s.includes(r)}):e,[_,e]),T=async(e,s)=>{y(e);try{let r=(0,C.Qg)(R.Cn,"setUserRole");await r({targetUserId:e,isAdmin:s}),a(a=>a.map(a=>a.uid===e?{...a,isAdmin:s}:a)),s?L({title:"Usu\xe1rio Promovido!",description:"Pe\xe7a para que ele(a) fa\xe7a logout e login novamente para ativar as permiss\xf5es de admin.",duration:7e3}):L({title:"Usu\xe1rio Rebaixado.",description:"As permiss\xf5es de admin foram removidas.",variant:"info"})}catch(e){L({title:"Erro ao alterar permiss\xe3o.",description:e.message,variant:"destructive"})}finally{y(null)}},q=e=>{S(e),U(!0)},z=e=>e.firstName&&e.lastName?"".concat(e.firstName," ").concat(e.lastName):e.displayName||"N/A",P=e=>{let a=e.replace(/\D/g,"");a?window.open("https://wa.me/".concat(a),"_blank"):L({title:"N\xfamero de telefone inv\xe1lido.",variant:"warning"})};return(0,r.jsxs)("div",{className:"container mx-auto",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2 text-foreground",children:"Gerenciamento de Usu\xe1rios"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-8",children:"Visualize e gerencie as permiss\xf5es dos usu\xe1rios da plataforma."}),(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(i.ZB,{children:"Usu\xe1rios Cadastrados"}),(0,r.jsx)(i.BT,{children:"Abaixo est\xe1 a lista de todos os usu\xe1rios registrados no sistema."})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-muted/40 rounded-lg",children:[(0,r.jsx)(x.A,{className:"h-8 w-8 text-primary"}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total de Usu\xe1rios"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:e.length})]})]})]})}),(0,r.jsxs)(i.Wu,{children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(f.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,r.jsx)(c.p,{placeholder:"Pesquisar por nome ou e-mail...",value:_,onChange:e=>B(e.target.value),className:"pl-10"})]})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(n.XI,{children:[(0,r.jsx)(n.A0,{children:(0,r.jsxs)(n.Hj,{children:[(0,r.jsx)(n.nd,{className:"w-[180px]",children:"Data de Cadastro"}),(0,r.jsx)(n.nd,{children:"Nome"}),(0,r.jsx)(n.nd,{children:"E-mail"}),(0,r.jsx)(n.nd,{className:"text-right",children:"Saldo"}),(0,r.jsx)(n.nd,{className:"text-center",children:"Status"}),(0,r.jsx)(n.nd,{className:"text-center",children:"WhatsApp"}),(0,r.jsx)(n.nd,{className:"text-right",children:"A\xe7\xf5es"})]})}),(0,r.jsx)(n.BF,{children:s?(0,r.jsx)(n.Hj,{children:(0,r.jsx)(n.nA,{colSpan:7,className:"text-center h-24",children:(0,r.jsx)(p.A,{className:"h-6 w-6 animate-spin mx-auto"})})}):H.length>0?H.map(e=>(0,r.jsxs)(n.Hj,{children:[(0,r.jsx)(n.nA,{children:e.createdAt?(0,A.GP)(new Date(1e3*e.createdAt.seconds),"dd/MM/yyyy '\xe0s' HH:mm"):"N/A"}),(0,r.jsx)(n.nA,{className:"font-medium",children:z(e)}),(0,r.jsx)(n.nA,{children:e.email}),(0,r.jsx)(n.nA,{className:"text-right",children:(e.balance||0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}),(0,r.jsx)(n.nA,{className:"text-center",children:v===e.uid?(0,r.jsx)(p.A,{className:"h-4 w-4 animate-spin mx-auto"}):(0,r.jsx)(u.E,{variant:e.isAdmin?"success":"outline",children:e.isAdmin?"Admin":"Usu\xe1rio"})}),(0,r.jsx)(n.nA,{className:"text-center",children:e.phone?(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,r.jsx)("span",{className:"font-mono text-sm",children:e.phone}),(0,r.jsx)(o.Bc,{children:(0,r.jsxs)(o.m_,{children:[(0,r.jsx)(o.k$,{asChild:!0,children:(0,r.jsx)(m.$,{variant:"ghost",size:"icon",onClick:()=>P(e.phone),"aria-label":"Contatar no WhatsApp",disabled:v===e.uid,children:(0,r.jsx)(h.A,{className:"h-4 w-4"})})}),(0,r.jsx)(o.ZI,{children:(0,r.jsx)("p",{children:"Contatar via WhatsApp"})})]})})]}):(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"N\xe3o cadastrado"})}),(0,r.jsxs)(n.nA,{className:"text-right",children:[(0,r.jsx)(m.$,{variant:"ghost",size:"icon",onClick:()=>q(e),"aria-label":"Editar Usu\xe1rio",disabled:v===e.uid,children:(0,r.jsx)(j.A,{className:"h-4 w-4"})}),(0,r.jsxs)(d.rI,{children:[(0,r.jsx)(d.ty,{asChild:!0,children:(0,r.jsx)(m.$,{variant:"ghost",size:"icon","aria-label":"Mais A\xe7\xf5es",disabled:v===e.uid,children:(0,r.jsx)(N.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(d.SQ,{align:"end",children:[(0,r.jsx)(d.lp,{children:"A\xe7\xf5es R\xe1pidas"}),(0,r.jsx)(d.mB,{}),e.isAdmin?(0,r.jsx)(d._2,{onClick:()=>T(e.uid,!1),disabled:v===e.uid,children:"Rebaixar para Usu\xe1rio"}):(0,r.jsx)(d._2,{onClick:()=>T(e.uid,!0),disabled:v===e.uid,children:"Promover a Admin"})]})]})]})]},e.uid)):(0,r.jsx)(n.Hj,{children:(0,r.jsx)(n.nA,{colSpan:7,className:"text-center h-24",children:"Nenhum usu\xe1rio encontrado."})})})]})})]})]}),(0,r.jsx)(w,{user:k,isOpen:E,onOpenChange:U,onUserUpdate:e=>{a(a=>a.map(a=>a.uid===e.uid?e:a)),F()}})]})}},85127:(e,a,s)=>{"use strict";s.d(a,{A0:()=>n,BF:()=>d,Hj:()=>o,XI:()=>i,nA:()=>u,nd:()=>c});var r=s(95155),t=s(12115),l=s(59434);let i=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:a,className:(0,l.cn)("w-full caption-bottom text-sm",s),...t})})});i.displayName="Table";let n=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("thead",{ref:a,className:(0,l.cn)("[&_tr]:border-b",s),...t})});n.displayName="TableHeader";let d=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("tbody",{ref:a,className:(0,l.cn)("[&_tr:last-child]:border-0",s),...t})});d.displayName="TableBody",t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("tfoot",{ref:a,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t})}).displayName="TableFooter";let o=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("tr",{ref:a,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t})});o.displayName="TableRow";let c=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("th",{ref:a,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...t})});c.displayName="TableHead";let u=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("td",{ref:a,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...t})});u.displayName="TableCell",t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("caption",{ref:a,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",s),...t})}).displayName="TableCaption"},91394:(e,a,s)=>{"use strict";s.d(a,{BK:()=>d,eu:()=>n,q5:()=>o});var r=s(95155),t=s(12115),l=s(85977),i=s(59434);let n=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)(l.bL,{ref:a,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...t})});n.displayName=l.bL.displayName;let d=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)(l._V,{ref:a,className:(0,i.cn)("aspect-square h-full w-full",s),...t})});d.displayName=l._V.displayName;let o=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)(l.H4,{ref:a,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...t})});o.displayName=l.H4.displayName}},e=>{var a=a=>e(e.s=a);e.O(0,[2992,7138,4277,7106,7239,1784,9397,9205,3421,725,6783,6515,8441,1684,7358],()=>a(12432)),_N_E=e.O()}]);